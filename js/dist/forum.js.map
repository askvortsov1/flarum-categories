{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@askvortsov/flarum-categories/webpack/bootstrap","webpack://@askvortsov/flarum-categories/webpack/runtime/compat get default export","webpack://@askvortsov/flarum-categories/webpack/runtime/define property getters","webpack://@askvortsov/flarum-categories/webpack/runtime/hasOwnProperty shorthand","webpack://@askvortsov/flarum-categories/webpack/runtime/make namespace object","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/extend']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/Model']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['tags/models/Tag']\"","webpack://@askvortsov/flarum-categories/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@askvortsov/flarum-categories/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['forum/app']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/components/Page']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/helpers/listItems']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['tags/utils/sortTags']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['tags/helpers/tagLabel']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/Component']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/components/Link']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@askvortsov/flarum-categories/./src/forum/components/StatWidget.tsx","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/helpers/humanTime']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/utils/string']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['forum/components/UserCard']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/helpers/textContrastClass']\"","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@askvortsov/flarum-categories/./src/forum/components/LastDiscussionWidget.tsx","webpack://@askvortsov/flarum-categories/./src/forum/helpers/lastDiscussionAvatar.js","webpack://@askvortsov/flarum-categories/./src/forum/components/Category.tsx","webpack://@askvortsov/flarum-categories/./src/forum/components/CategoriesPage.tsx","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['tags/forum/components/TagsPage']\"","webpack://@askvortsov/flarum-categories/./src/forum/index.js","webpack://@askvortsov/flarum-categories/external root \"flarum.core.compat['extensions/afrux-forum-widgets-core/common/utils/sortWidgets']\""],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['tags/models/Tag'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/listItems'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['tags/utils/sortTags'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['tags/helpers/tagLabel'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","import Component from 'flarum/common/Component';\r\nimport icon from 'flarum/common/helpers/icon';\r\nimport ItemList from 'flarum/common/utils/ItemList';\r\nimport classList from 'flarum/common/utils/classList';\r\nimport app from 'flarum/forum/app';\r\n\r\nimport type Mithril from 'mithril';\r\n\r\ninterface Attrs {\r\n  count: number;\r\n  icon: string;\r\n  label: Mithril.Children;\r\n  className: string;\r\n}\r\n\r\nexport default class StatWidget extends Component<Attrs> {\r\n  view() {\r\n    return (\r\n      <div class={classList('StatWidget', { 'Categories-compactMobileModeEnabled': !!app.forum.attribute('categories.compactMobile') }, this.attrs.className)}>\r\n        {this.content().toArray()}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  content() {\r\n    const items = new ItemList();\r\n\r\n    items.add('count', <div class=\"StatWidget-count\">{this.attrs.count}</div>, 100);\r\n    items.add(\r\n      'label',\r\n      <div class=\"StatWidget-label\" class={this.attrs.className+'muted'}>\r\n        <span className=\"Categories-showOnMobile\">{icon(this.attrs.icon)}</span>\r\n        <span className=\"Categories-hideOnMobile\">{this.attrs.label}</span>\r\n      </div>,\r\n      80\r\n    );\r\n\r\n    return items;\r\n  }\r\n}\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/humanTime'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/string'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserCard'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/textContrastClass'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","import app from 'flarum/forum/app';\r\nimport Component from 'flarum/common/Component';\r\nimport username from 'flarum/common/helpers/username';\r\nimport humanTime from 'flarum/common/helpers/humanTime';\r\nimport { truncate } from 'flarum/common/utils/string';\r\nimport Link from 'flarum/common/components/Link';\r\nimport UserCard from 'flarum/forum/components/UserCard';\r\nimport type Discussion from 'flarum/common/models/Discussion';\r\nimport ItemList from 'flarum/common/utils/ItemList';\r\nimport Tag from 'flarum/tags/models/Tag';\r\nimport classList from 'flarum/common/utils/classList';\r\nimport type Mithril from 'mithril';\r\nimport textContrastClass from 'flarum/common/helpers/textContrastClass';\r\nimport lastDiscussionAvatar from '../helpers/lastDiscussionAvatar';\r\n\r\ninterface Attrs {\r\n  discussion: Discussion;\r\n  selectedTag: {\r\n    tag: Tag;\r\n    isChild: boolean;\r\n    isBackgroundTagColored: boolean;\r\n  }\r\n}\r\n\r\nexport default class LastDiscussionWidget extends Component<Attrs> {\r\n  /**\r\n   * Whether or not the user hover card is visible.\r\n   */\r\n  cardVisible!: boolean;\r\n\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n\r\n    this.cardVisible = false;\r\n  }\r\n\r\n  view() {\r\n    const discussion = this.attrs.discussion;\r\n\r\n    if (!discussion) {\r\n      return <div class=\"LastDiscussion\">{app.translator.trans('askvortsov-categories.forum.last_discussion_widget.no_discussions')}</div>;\r\n    }\r\n\r\n    const user = discussion.lastPostedUser();\r\n\r\n    return (\r\n      <Link class=\"LastDiscussion\" href={app.route.discussion(discussion, discussion.lastPostNumber() ?? 0)}>\r\n        {this.content().toArray()}\r\n      </Link>\r\n    );\r\n  }\r\n\r\n  content() {\r\n    const items = new ItemList();\r\n\r\n    const discussion = this.attrs.discussion;\r\n    const user = discussion.lastPostedUser();\r\n    let className = 'auto-color-text';\r\n\r\n    if (this.attrs.selectedTag.isChild) {\r\n      if (this.attrs.selectedTag.isBackgroundTagColored) {\r\n        className = textContrastClass(this.attrs.selectedTag.tag.color());\r\n      }\r\n    } else if (this.attrs.selectedTag.isBackgroundTagColored) {\r\n      className = textContrastClass(this.attrs.selectedTag.tag.color());\r\n    }\r\n\r\n    items.add(\r\n      'avatar',\r\n      lastDiscussionAvatar(user, \"LastDiscussion-avatar\"),\r\n      100\r\n    );\r\n\r\n    items.add(\r\n      'mainContent',\r\n      <div class={classList('LastDiscussion-content', className)}>\r\n        <div class={classList(\"LastDiscussion-bottomRow\", className+'muted' )}>\r\n          {humanTime(discussion.lastPostedAt()!)}{' '}\r\n          <Link className={classList('LastDiscussion-usernameLink', className+'muted')}  href={user ? app.route.user(user) : '#'}>\r\n            <span style={{ display: 'inline', margin: '0 4px' }} role=\"presentation\">\r\n              |\r\n            </span>\r\n            {username(user)}\r\n          </Link>\r\n        </div>\r\n        <div class=\"LastDiscussion-topRow\">{truncate(discussion.title(), 26)}</div>\r\n      </div>,\r\n      50\r\n    );\r\n\r\n    let card: Mithril.Children = null;\r\n\r\n    if (user && this.cardVisible) {\r\n      card = UserCard.component({\r\n        user,\r\n        className: 'UserCard--popover',\r\n        controlsButtonClassName: 'Button Button--icon Button--flat',\r\n      });\r\n    }\r\n\r\n    items.add('card', <div class=\"LastDiscussion-userCardContainer\">{card}</div>, 10);\r\n\r\n    return items;\r\n  }\r\n\r\n  oncreate(vnode) {\r\n    super.oncreate(vnode);\r\n\r\n    let timeout: number;\r\n\r\n    this.$()\r\n      .on('mouseover', '.LastDiscussion-avatar, .LastDiscussion-usernameLinkUserCard, .username, .UserCard', () => {\r\n        clearTimeout(timeout);\r\n        timeout = window.setTimeout(this.showCard.bind(this), 300);\r\n      })\r\n      .on('mouseout', '.LastDiscussion-avatar, .LastDiscussion-usernameLinkUserCard, .username, .UserCard', () => {\r\n        clearTimeout(timeout);\r\n        timeout = window.setTimeout(this.hideCard.bind(this), 150);\r\n      });\r\n  }\r\n\r\n  onremove(vnode): void {\r\n    super.onremove(vnode);\r\n\r\n    this.$().off('mouseover mouseout');\r\n  }\r\n\r\n  /**\r\n   * Show the user card.\r\n   */\r\n  showCard() {\r\n    this.cardVisible = true;\r\n\r\n    m.redraw();\r\n\r\n    setTimeout(() => this.$('.UserCard').addClass('in'));\r\n  }\r\n\r\n  /**\r\n   * Hide the user card.\r\n   */\r\n  hideCard() {\r\n    $('.UserCard').removeClass('in');\r\n    this.cardVisible = false;\r\n    m.redraw();\r\n  }\r\n}\r\n","import icon from 'flarum/common/helpers/icon';\nimport avatar from 'flarum/common/helpers/avatar';\nimport Link from 'flarum/common/components/Link';\nimport username from 'flarum/common/helpers/username';\nimport extractText from 'flarum/common/utils/extractText';\n\nexport default function lastDiscussionAvatar(user, className) {\n  let avatarName;\n  let avatarDisplay;\n  if (user && user.id() > 0) {\n      avatarName = extractText(username(user));\n      avatarDisplay = avatar(user);\n  }\n  if (!avatarDisplay) {\n    avatarName = \"Anonymous\";\n    avatarDisplay = <span class=\"Avatar Avatar--anonymous\" loading=\"lazy\">{icon('fas fa-question')}</span>;\n  }\n\n  return <Link className={className} href={user ? app.route.user(user) : '#'} aria-label={avatarName}>\n        {avatarDisplay}\n      </Link>\n}\n","import Component from 'flarum/common/Component';\r\nimport Link from 'flarum/common/components/Link';\r\n\r\nimport icon from 'flarum/common/helpers/icon';\r\nimport ItemList from 'flarum/common/utils/ItemList';\r\nimport sortTags from 'flarum/tags/utils/sortTags';\r\n\r\nimport StatWidget from './StatWidget';\r\nimport LastDiscussionWidget from './LastDiscussionWidget';\r\nimport app from 'flarum/forum/app';\r\nimport classList from 'flarum/common/utils/classList';\r\nimport textContrastClass from 'flarum/common/helpers/textContrastClass';\r\n\r\nimport type Mithril from 'mithril';\r\n\r\ninterface Attrs {\r\n  model: any;\r\n  parent: any;\r\n  enablePrimaryTagColor: boolean;\r\n  enablePrimaryChildTagColor: boolean;\r\n}\r\n\r\n/*\r\n * Provide compatibility for Flarum Tag Passwords extension, this is to ensure that locked tag with Password or Group permission has view restriction on latest discussion.\r\n * To know if a tag is protected, there is an isUnlocked variable that is specific for this extension.\r\n * https://github.com/datlechin/flarum-tag-passwords\r\n * \r\n */\r\ninterface TagLocked {\r\n  icon: icon;\r\n  text: string;\r\n  isVisible: boolean;\r\n}\r\n\r\nexport default class Category extends Component<Attrs> {\r\n  tag!: any;\r\n  isChild!: boolean;\r\n  collapsed!: boolean;\r\n  compactMobileMode!: boolean;\r\n  tagLocked!: TagLocked;\r\n\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n\r\n    this.tag = this.attrs.model;\r\n\r\n    this.isChild = this.attrs.parent != null && this.attrs.parent != undefined;\r\n\r\n    this.collapsed = false;\r\n\r\n    // Identify if the tag has been Goup or Password protected with flarum-tag-passwords extension.\r\n    if (typeof this.tag.isUnlocked == 'function') {\r\n      if ((this.tag.isGroupProtected() || this.tag.isPasswordProtected()) && !this.tag.isUnlocked()) {\r\n        this.tagLocked = {\r\n          icon: this.tag.isPasswordProtected() ? icon('fas fa-lock') : icon('fas fa-user-lock'),\r\n          text: this.tag.isPasswordProtected() ? app.translator.trans('datlechin-tag-passwords.forum.tags_page.password_protected') : app.translator.trans('datlechin-tag-passwords.forum.tags_page.group_protected'),\r\n          isVisible: this.tag.isProtectedTagDisplayedForTagsPage() == true\r\n        };\r\n      }\r\n    }\r\n\r\n    window.addEventListener('resize', function () {\r\n      m.redraw();\r\n    });\r\n  }\r\n\r\n  view() {\r\n    const tag = this.tag;\r\n\r\n    if (!tag) {\r\n      return null;\r\n    } else if (this.tagLocked && !this.tagLocked.isVisible) {\r\n      // Hide the navigation when protected Tag in 'Tag Passwords > Display protected Tag in Tags page navigation' is disabled\r\n      return null;\r\n    }\r\n\r\n    this.compactMobileMode = !!app.forum.attribute('categories.compactMobile');\r\n\r\n    return (\r\n      <li\r\n        className={classList('TagCategory', `TagCategory-${tag.slug()}`, {\r\n          SubCategory: this.isChild,\r\n          ParentCategory: !this.isChild,\r\n          compactMobile: this.compactMobileMode,\r\n        })}\r\n      >\r\n        {this.categoryItems().toArray()}\r\n      </li>\r\n    );\r\n  }\r\n\r\n  categoryItems() {\r\n    const items = new ItemList();\r\n    const tag = this.tag;\r\n\r\n    const children = this.isChild ? [] : sortTags(tag.children() || []);\r\n\r\n    let style: Record<string, unknown> = {};\r\n    if (this.isChild) {\r\n      if (this.attrs.enablePrimaryChildTagColor) {\r\n        style.backgroundColor = this.tag.color();\r\n      }\r\n    } else if (this.attrs.enablePrimaryTagColor) {\r\n      style.backgroundColor = this.tag.color();\r\n    }\r\n    items.add(\r\n      'link',\r\n      <Link\r\n        className={`TagCategory-content ${app.forum.attribute('categories.compactMobile')? 'compactMobile' : '' } TagCategory-content-${tag.slug()}`}\r\n        style={style}\r\n        href={app.route.tag(tag)}\r\n      >\r\n        {this.contentItems().toArray()}\r\n      </Link>,\r\n      100\r\n    );\r\n\r\n    if (!this.compactMobileMode && !this.isChild) {\r\n      items.add(\r\n        'children',\r\n        <ol className=\"TagCategory-subTagList\">{children.map((child) => [Category.component({ model: child, parent: this, enablePrimaryChildTagColor: this.attrs.enablePrimaryChildTagColor})])}</ol>,\r\n        10\r\n      );\r\n    }\r\n\r\n    return items;\r\n  }\r\n\r\n  contentItems() {\r\n    const items = new ItemList();\r\n\r\n    const children = this.isChild ? [] : sortTags(this.tag.children() || []);\r\n\r\n    let className = 'auto-color-text';\r\n    if (this.attrs.enablePrimaryTagColor || (this.isChild && this.attrs.enablePrimaryChildTagColor)) {\r\n      className =  textContrastClass(this.tag.color());\r\n    }\r\n\r\n    items.add('alignStart', <div className={classList('TagCategory-alignStart', className)}>{this.alignStartItems().toArray()}</div>, 100);\r\n\r\n    items.add('alignEnd', <div className={classList('TagCategory-alignEnd', className)}>{this.alignEndItems().toArray()}</div>, 50);\r\n\r\n    const childrenInContent = !this.isChild && this.compactMobileMode;\r\n\r\n    if (childrenInContent && !this.collapsed) {\r\n      items.add(\r\n        'children',\r\n        <ol className=\"TagCategory-subTagList\">{children.map((child) => [Category.component({ model: child, parent: this, enablePrimaryChildTagColor: this.attrs.enablePrimaryChildTagColor})])}</ol>,\r\n        10\r\n      );\r\n    }\r\n\r\n    return items;\r\n  }\r\n\r\n  alignStartItems() {\r\n    const items = new ItemList();\r\n\r\n    const children = this.isChild ? [] : sortTags(this.tag.children() || []);\r\n    let style: Record<string, unknown> = {};\r\n    if (this.isChild) {\r\n      if (!this.attrs.enablePrimaryChildTagColor) {\r\n        style.color = this.tag.color();\r\n      }\r\n    } else if (!this.attrs.enablePrimaryTagColor) {\r\n      style.color = this.tag.color();\r\n    }\r\n    items.add('icon', <span className='TagCategory-icon' style={style}>{this.iconItems().toArray()}</span>, 100);\r\n\r\n    items.add('main', <div className=\"TagCategory-main\">{this.mainItems().toArray()}</div>, 50);\r\n\r\n    if (!!children.length) {\r\n      items.add(\r\n        'toggleArrow',\r\n        <button\r\n          className=\"TagCategory-toggleArrow Button--ua-reset\"\r\n          onclick={(e: MouseEvent) => {\r\n            this.toggleArrow(e);\r\n          }}\r\n        >\r\n          {icon(this.collapsed ? 'fas fa-caret-down' : 'fas fa-caret-up')}\r\n        </button>,\r\n        10\r\n      );\r\n    }\r\n\r\n    return items;\r\n  }\r\n\r\n  alignEndItems() {\r\n    const items = new ItemList();\r\n\r\n    if (this.tagLocked) {\r\n      items.add('locked', <div className=\"TagCategory-locked\">{this.lockedItems().toArray()}</div>, 100);\r\n      return items;\r\n    }\r\n\r\n    const tag = this.tag;\r\n\r\n    items.add('stats', <div className=\"TagCategory-stats StatWidgetList\">{this.statItems().toArray()}</div>, 100);\r\n\r\n    items.add(\r\n      'lastDiscussion',\r\n      <div className={classList('TagCategory-lastDiscussion', { empty: !tag.lastPostedDiscussion() })}>{this.lastDiscussionItems().toArray()}</div>,\r\n      50\r\n    );\r\n\r\n    return items;\r\n  }\r\n\r\n  lockedItems() {\r\n    const items = new ItemList();\r\n    const classes = this.compactMobileMode ? 'fa-stack fa-1x' : 'fa-stack fa-2x';\r\n    items.add(\r\n      'icon',\r\n      <span className={classes}>\r\n        {\r\n          <i className=\"fa-stack-2x\" style={{ color: this.tag.color() }}></i>\r\n        }\r\n        {this.tagLocked.icon}\r\n      </span>,\r\n      10\r\n    );\r\n    items.add(\r\n      'LockedText',\r\n      <div className={classList('TagCategory-lockedText')}>{this.tagLocked.text}</div>,\r\n      50\r\n    );\r\n    return items;\r\n  }\r\n\r\n  iconItems() {\r\n    const items = new ItemList();\r\n\r\n    if (this.tag.icon() && this.isChild) {\r\n      const style: Record<string, unknown> = {};\r\n\r\n      let iconClasses = ['fa-stack-1x CategoryIcon'];\r\n\r\n      if (app.forum.attribute('categories.childBareIcon')) {\r\n        if (this.attrs.enablePrimaryChildTagColor) {\r\n          style.color = this.tag.color();\r\n        } else {\r\n          iconClasses.push('NoBackgroundCategoryIcon', 'auto-child-color');\r\n        }\r\n      } else {\r\n        if (this.attrs.enablePrimaryChildTagColor) {\r\n          iconClasses.push(textContrastClass(this.tag.color()));\r\n        } else {\r\n          style.color = this.tag.color();\r\n        }\r\n      }\r\n\r\n      const className = this.compactMobileMode ? 'fa-stack fa-1x' : 'fa-stack fa-2x';\r\n\r\n      items.add(\r\n        'icon',\r\n        <span className={className}>\r\n          {!!app.forum.attribute('categories.childBareIcon') && (\r\n            <i className=\"fa fa-circle fa-stack-2x icon-background\" style={this.attrs.enablePrimaryChildTagColor?{}:{ color: this.tag.color() }}></i>\r\n          )}\r\n          {icon(this.tag.icon(), { className: classList(iconClasses), style: style })}\r\n        </span>,\r\n        10\r\n      );\r\n    } else if (this.tag.icon() && !app.forum.attribute('categories.parentRemoveIcon')) {\r\n      const classes = this.compactMobileMode ? 'fa-stack fa-2x' : 'fa-stack fa-3x';\r\n\r\n      items.add('icon', <span className={classes}>{icon(this.tag.icon(), { className: 'fa-stack-1x CategoryIcon' })}</span>, 10);\r\n    }\r\n\r\n    return items;\r\n  }\r\n\r\n  mainItems() {\r\n    const items = new ItemList();\r\n\r\n    items.add('name', <h4 className=\"TagCategory-name\">{this.tag.name()}</h4>, 15);\r\n    \r\n    let className = 'auto-color-text';\r\n    if (this.isChild) {\r\n      if (this.attrs.enablePrimaryChildTagColor) {\r\n        className = textContrastClass(this.tag.color())+'muted';\r\n      }\r\n    } else if (this.attrs.enablePrimaryTagColor) {\r\n      className = textContrastClass(this.tag.color())+'muted';\r\n    }\r\n    if (this.tag.description() && (this.isChild || !app.forum.attribute('categories.parentRemoveDescription'))) {\r\n      items.add('description', <div className={classList('TagCategory-description', className)}>{this.tag.description()}</div>, 10);\r\n    }\r\n\r\n    return items;\r\n  }\r\n\r\n  statItems() {\r\n    const items = new ItemList();\r\n    let className = 'auto-color-text';\r\n    \r\n    if (this.isChild) {\r\n      if (this.attrs.enablePrimaryChildTagColor) {\r\n        className = textContrastClass(this.tag.color());\r\n      }\r\n    } else if (this.attrs.enablePrimaryTagColor) {\r\n      className = textContrastClass(this.tag.color());\r\n    }\r\n    if (this.isChild || !app.forum.attribute('categories.parentRemoveStats')) {\r\n      items.add(\r\n        'discussionCount',\r\n        StatWidget.component({\r\n          count: Intl.NumberFormat().format(this.tag.discussionCount()),\r\n          label: app.translator.trans('askvortsov-categories.forum.stat-widgets.discussion_label'),\r\n          icon: 'fas fa-file-alt',\r\n          className: className,\r\n        }),\r\n        15\r\n      );\r\n\r\n      items.add(\r\n        'postCount',\r\n        StatWidget.component({\r\n          count: Intl.NumberFormat().format(this.tag.postCount()),\r\n          label: app.translator.trans('askvortsov-categories.forum.stat-widgets.post_label'),\r\n          icon: 'fas fa-comment',\r\n          className: className,\r\n        }),\r\n        10\r\n      );\r\n    }\r\n\r\n    return items;\r\n  }\r\n\r\n  lastDiscussionItems() {\r\n    const items = new ItemList();\r\n\r\n    if (this.isChild || !app.forum.attribute('categories.parentRemoveLastDiscussion')) {\r\n      items.add(\r\n        'lastDiscussion',\r\n        LastDiscussionWidget.component({\r\n          discussion: this.tag.lastPostedDiscussion(),\r\n          selectedTag: {\r\n            tag: this.tag,\r\n            isChild: this.isChild,\r\n            isBackgroundTagColored: this.isChild? this.attrs.enablePrimaryChildTagColor: this.attrs.enablePrimaryTagColor\r\n          }\r\n        }),\r\n        10\r\n      );\r\n    }\r\n\r\n    return items;\r\n  }\r\n\r\n  oncreate(vnode) {\r\n    super.oncreate(vnode);\r\n\r\n    this.$('.TagCategory-content,.TagCategory-toggleArrow').on('mouseenter', function (e) {\r\n      $(this).addClass('hover');\r\n      if ($(this).parent().hasClass('SubCategory') || $(this).hasClass('TagCategory-toggleArrow')) {\r\n        $(this).closest('.ParentCategory').children('.TagCategory-content').removeClass('hover');\r\n      }\r\n    });\r\n\r\n    this.$('.TagCategory-content,.TagCategory-toggleArrow').on('mouseleave', function (e) {\r\n      $(this).removeClass('hover');\r\n      if ($(this).parent().hasClass('SubCategory') || $(this).hasClass('TagCategory-toggleArrow')) {\r\n        $(this).closest('.ParentCategory').children('.TagCategory-content').addClass('hover');\r\n      }\r\n    });\r\n  }\r\n\r\n  onremove(vnode: Mithril.VnodeDOM<Attrs, this>): void {\r\n    super.onremove(vnode);\r\n\r\n    this.$('.TagCategory-content,.TagCategory-toggleArrow').off('mouseenter');\r\n    this.$('.TagCategory-content,.TagCategory-toggleArrow').off('mouseleave');\r\n  }\r\n\r\n  toggleArrow(e: MouseEvent) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    this.collapsed = !this.collapsed;\r\n    m.redraw();\r\n  }\r\n}\r\n","import app from 'flarum/forum/app';\r\nimport Page from 'flarum/common/components/Page';\r\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\r\nimport IndexPage from 'flarum/forum/components/IndexPage';\r\nimport listItems from 'flarum/common/helpers/listItems';\r\nimport ItemList from 'flarum/common/utils/ItemList';\r\nimport extractText from 'flarum/common/utils/extractText';\r\nimport sortTags from 'flarum/tags/utils/sortTags';\r\nimport tagLabel from 'flarum/tags/helpers/tagLabel';\r\n\r\nimport Category from './Category';\r\n\r\n/*\r\n* Used for finding the correct location of widget containers, widget has undefined className which is used to compare and find.\r\n* position types:\r\n* POSITION_ANY = No position check (Used for Right Side Widget)\r\n* POSITION_FIRST = First container only (Used for Header Widget)\r\n* POSITION_AFTER_FIRST = After the first container (Used for the Footer Widget)\r\n*/\r\nconst POSITION_ANY = 0;\r\nconst POSITION_FIRST = 1;\r\nconst POSITION_AFTER_FIRST = 2;\r\n\r\nfunction findWidgetContainer(vdom, classNames, classNameIndex, position) {\r\n  for (let i = 0; i < vdom.children.length; i++) {\r\n    const child = vdom.children[i];\r\n    const findClassName = classNames[classNameIndex];\r\n    const isClassNameMatch = child.attrs.className? child.attrs.className.indexOf(findClassName) !== -1: false;\r\n    if (isClassNameMatch || findClassName == child.attrs.className) {\r\n      let isValid = false;\r\n      if (position === POSITION_ANY || isClassNameMatch) {\r\n        isValid = true;\r\n      } else if (position === POSITION_FIRST && i == 0) {\r\n        isValid = true;\r\n      } else if (position === POSITION_AFTER_FIRST && i > 0) {\r\n        isValid = true;\r\n      }\r\n      if (isValid) {\r\n        classNameIndex += 1;\r\n        if (classNameIndex == classNames.length) {\r\n          // Found the last container from the classNames array\r\n          return child;\r\n        } else {\r\n          return findWidgetContainer(child, classNames, classNameIndex, position);\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport default class CategoriesPage extends Page {\r\n  tags!: any[];\r\n  loading!: boolean;\r\n\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n\r\n    app.history.push('categories', extractText(app.translator.trans('askvortsov-category.forum.header.back_to_categories_tooltip')));\r\n\r\n    this.tags = [];\r\n\r\n    const preloaded = app.preloadedApiDocument<any>();\r\n\r\n    if (preloaded) {\r\n      this.tags = sortTags(preloaded.filter((tag: any) => !tag.isChild()));\r\n      return;\r\n    }\r\n\r\n    this.loading = true;\r\n\r\n    app.tagList.load(['parent', 'children', 'lastPostedDiscussion', 'lastPostedDiscussion.lastPostedUser']).then(() => {\r\n      this.tags = sortTags(app.store.all('tags').filter((tag) => !tag.isChild()));\r\n\r\n      this.loading = false;\r\n\r\n      m.redraw();\r\n    });\r\n  }\r\n\r\n  view() {\r\n    if (this.loading) {\r\n      return <LoadingIndicator />;\r\n    }\r\n\r\n    return <div className='CategoriesPage'>{this.pageItems().toArray()}</div>;\r\n  }\r\n\r\n  pageItems() {\r\n    const items = new ItemList();\r\n\r\n    items.add('hero', IndexPage.prototype.hero(), 100);\r\n\r\n    items.add('container', <div class=\"container\">{this.containerItems().toArray()}</div>, 50);\r\n\r\n    return items;\r\n  }\r\n\r\n  containerItems() {\r\n    const items = new ItemList();\r\n    const indexPage = IndexPage.prototype.view();\r\n    // Only check for header widget if enable in the settings\r\n    if (app.forum.attribute('categories.widgetHeader')) {\r\n      const foundHeaderWidget= findWidgetContainer(indexPage, ['container', undefined], 0, POSITION_FIRST);\r\n      if (foundHeaderWidget) {\r\n        items.add('header-widget', foundHeaderWidget, 100);\r\n      }\r\n    }\r\n\r\n    items.add(\"sideNavContainer\", <div class={app.forum.attribute('categories.fullPageDesktop') ? 'topNavContainer' : 'sideNavContainer'}>{this.contentItems().toArray()}</div>, 50);\r\n\r\n    // Only check for footer widget if enable in the settings\r\n    if (app.forum.attribute('categories.widgetFooter')) {\r\n      const foundFooterWidget= findWidgetContainer(indexPage, ['container', undefined], 0, POSITION_AFTER_FIRST);\r\n      if (foundFooterWidget) {\r\n        items.add('footer-widget', foundFooterWidget, 0);\r\n      }\r\n    }\r\n    return items;\r\n  }\r\n\r\n  contentItems() {\r\n    const items = new ItemList();\r\n\r\n    const pinned = this.tags.filter((tag) => tag.position() !== null);\r\n    const cloud = this.tags.filter((tag) => tag.position() === null);\r\n\r\n    items.add(\r\n      'sideNav',\r\n        <nav className={app.forum.attribute('categories.fullPageDesktop') ? 'CategoriesPage-nav IndexPage-nav topNav' : 'CategoriesPage-nav IndexPage-nav sideNav'}>\r\n          <ul>{listItems(IndexPage.prototype.sidebarItems().toArray())}</ul>\r\n        </nav>,\r\n      100\r\n    );\r\n\r\n    items.add(\r\n      'categoriesList',\r\n      <div className=\"CategoriesPage-content sideNavOffset\">\r\n        <ol className=\"TagCategoryList\">\r\n          {pinned.map((tag) => {\r\n            return Category.component({ model: tag, enablePrimaryTagColor: app.forum.attribute('categories.enablePrimaryTagColor'), enablePrimaryChildTagColor: app.forum.attribute('categories.enablePrimaryChildTagColor') });\r\n          })}\r\n        </ol>\r\n\r\n        {cloud.length ? <div className=\"TagCloud\">{cloud.map((tag) => [tagLabel(tag, { link: true }), ' '])}</div> : ''}\r\n      </div>,\r\n      50\r\n    );\r\n    // Only check for right side widget if enable in the settings\r\n    if (app.forum.attribute('categories.widgetRight')) {\r\n      const indexPage = IndexPage.prototype.view();\r\n      const foundWidget= findWidgetContainer(indexPage, ['container','sideNavContainer', undefined], 0, POSITION_ANY);\r\n      if (foundWidget) {\r\n        items.add('widget', foundWidget, 0);\r\n      }\r\n    }\r\n    return items;\r\n  }\r\n\r\n  oncreate(vnode) {\r\n    super.oncreate(vnode);\r\n\r\n    app.setTitle(extractText(app.translator.trans('askvortsov-categories.forum.all_categories.meta_title_text')));\r\n  }\r\n}\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['tags/forum/components/TagsPage'];","import { extend } from 'flarum/common/extend';\r\nimport IndexPage from 'flarum/forum/components/IndexPage';\r\nimport LinkButton from 'flarum/common/components/LinkButton';\r\nimport Model from 'flarum/common/Model';\r\nimport Tag from 'flarum/tags/models/Tag';\r\nimport CategoriesPage from './components/CategoriesPage';\r\nimport TagsPage from 'flarum/tags/forum/components/TagsPage';\r\nimport Category from './components/Category';\r\nimport LastDiscussionWidget from './components/LastDiscussionWidget';\r\nimport StatWidget from './components/StatWidget';\r\nimport sortWidgets from 'flarum/extensions/afrux-forum-widgets-core/common/utils/sortWidgets';\r\n\r\n\r\nfunction pruneIndexNav(items, func) {\r\n  const isTagsPageVisible = app.forum.attribute('categories.keepTagsNav');\r\n\r\n  const isCustomTagsHidden = (app.current.matches(CategoriesPage) || app.current.matches(TagsPage));\r\n  for (const item in items.items) {\r\n    if (func(item)) {\r\n      if(item.startsWith('tag')) {\r\n        if(item == 'tags') {\r\n          /*\r\n          * Tags must be visible on the navibation bar, when the User has selected to keep Tags within the Extension Settings.\r\n          * Finding all items that begins with 'tag' will also load 'tags', due to custom tag are labelled 'tag1', 'tag2' and so-on\r\n          */\r\n          if (!isTagsPageVisible) {\r\n            items.remove(item);\r\n          }\r\n        } else {\r\n          /*\r\n          * This is for custom tags, where they should not be visible within CategoriesPage and TagsPage\r\n          */\r\n          if (isCustomTagsHidden) {\r\n            items.remove(item);\r\n          }\r\n        }\r\n      } else {\r\n        /*\r\n         * Remove widget on the left side if disabled from settings\r\n         */\r\n        if (!app.forum.attribute('categories.widgetLeft')) {\r\n          items.remove(item);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return items;\r\n}\r\n\r\napp.initializers.add('askvortsov/flarum-categories', () => {\r\n  app.routes.categories = {\r\n    path: '/categories',\r\n    component: CategoriesPage,\r\n  };\r\n\r\n  Tag.prototype.postCount = Model.attribute('postCount');\r\n\r\n  extend(IndexPage.prototype, 'navItems', function (items) {\r\n    items.add(\r\n      'categories',\r\n      <LinkButton icon=\"fas fa-th-list\" href={app.route('categories')}>\r\n        {app.translator.trans('askvortsov-categories.forum.index.categories_link')}\r\n      </LinkButton>,\r\n      -9.5\r\n    );\r\n\r\n    if (app.current.matches(CategoriesPage) || app.current.matches(TagsPage)) {\r\n      // There is not need to display More Tags button for Categories or Tags Page\r\n      items.remove('moreTags');\r\n    } else {\r\n      if (items.has('moreTags')) {\r\n        items.replace('moreTags', <LinkButton href={app.route('categories')}>{app.translator.trans('flarum-tags.forum.index.more_link')}</LinkButton>);\r\n      }\r\n    }\r\n\r\n    pruneIndexNav(items, (item) => item.startsWith('tag'));\r\n\r\n    return items;\r\n  });\r\n\r\n  extend(IndexPage.prototype, 'sidebarItems', function (items) {\r\n    pruneIndexNav(items, (item) => item !== 'newDiscussion' && item !== 'nav');\r\n  });\r\n});\r\n\r\nexport default {\r\n  'components/CategoriesPage': CategoriesPage,\r\n  'components/Category': Category,\r\n  'components/LastDiscussionWidget': LastDiscussionWidget,\r\n  'components/StatWidget': StatWidget,\r\n};\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['extensions/afrux-forum-widgets-core/common/utils/sortWidgets'];"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","StatWidget","_Component","apply","arguments","_proto","view","m","class","classList","app","this","attrs","className","content","toArray","_m","items","ItemList","add","count","icon","label","Component","LastDiscussionWidget","_this","_len","length","args","Array","_key","concat","cardVisible","oninit","vnode","_discussion$lastPostN","discussion","lastPostedUser","Link","href","lastPostNumber","user","selectedTag","isChild","isBackgroundTagColored","textContrastClass","tag","color","avatarName","avatarDisplay","id","extractText","username","avatar","loading","route","lastDiscussionAvatar","humanTime","lastPostedAt","style","display","margin","role","truncate","title","card","UserCard","controlsButtonClassName","oncreate","timeout","_this2","$","on","clearTimeout","window","setTimeout","showCard","hideCard","onremove","off","_this3","redraw","addClass","removeClass","Category","collapsed","compactMobileMode","tagLocked","model","parent","undefined","isUnlocked","isGroupProtected","isPasswordProtected","text","isVisible","isProtectedTagDisplayedForTagsPage","addEventListener","slug","SubCategory","ParentCategory","compactMobile","categoryItems","children","sortTags","enablePrimaryChildTagColor","backgroundColor","enablePrimaryTagColor","contentItems","map","child","component","alignStartItems","alignEndItems","_this4","iconItems","mainItems","onclick","e","toggleArrow","lockedItems","statItems","empty","lastPostedDiscussion","lastDiscussionItems","classes","iconClasses","push","name","description","Intl","NumberFormat","format","discussionCount","postCount","hasClass","closest","preventDefault","stopPropagation","POSITION_ANY","POSITION_FIRST","POSITION_AFTER_FIRST","findWidgetContainer","vdom","classNames","classNameIndex","position","i","findClassName","isClassNameMatch","indexOf","isValid","CategoriesPage","_Page","tags","preloaded","filter","then","LoadingIndicator","pageItems","IndexPage","containerItems","indexPage","foundHeaderWidget","foundFooterWidget","pinned","cloud","listItems","tagLabel","link","foundWidget","Page","pruneIndexNav","func","isTagsPageVisible","forum","attribute","isCustomTagsHidden","current","matches","TagsPage","item","startsWith","remove","initializers","routes","categories","path","Tag","Model","extend","LinkButton","translator","trans","has","replace"],"sourceRoot":""}